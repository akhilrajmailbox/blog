<link type="text/css" rel="stylesheet" media="screen" href="./default.css" id="default-css" />
<h1 id="web-kubectl-interface">Web Kubectl Interface</h1>
<p id="repository-visit">Do you want to visit the <a href="https://github.com/akhilrajmailbox/Web-Kubectl">Repository</a> ?</p>
<p><img src="https://raw.githubusercontent.com/akhilrajmailbox/Web-Kubectl/master/img/webkube.png" alt="webkubectl"></p>
<p>This is an custom application which can used for communicate with your k8s Cluster without any kubectl configuration on your local system. <code>web-kubectl</code> have these features...</p>
<ul>
<li><code>2FA</code> Authentication</li>
<li>Web interface</li>
<li>Security and Permission customization with <code>rbac</code></li>
<li>Awesome terminal Interface</li>
</ul>
<h2 id="two-factor-authentication-with-google-authenticator">Two Factor Authentication with Google Authenticator</h2>
<p>I set up <a href="https://www.linuxbabe.com/ubuntu/ssh-two-factor-authentication-ubuntu-16-04-google-authenticator">SSH two factor authentication on Ubuntu 16.04</a> server using the well-known Google Authenticator. Once you set it up, the security of your SSH server will be hugely increased.</p>
<p>Two factor authentication, also known as two-step verification, requires you to enter two pieces of information in order to login. Google Authenticator generates a one-time password using a shared secret key and the current time. Not only do you need to provide the correct username and password, but also have to enter a one-time password generated by Google Authenticator to log in to your SSH server.</p>
<p>After your deployment, check the logs for the deployment and scan the QR Code / take the key with <code>Google Authenticator</code> application on your phone, thats it. done...!</p>
<p><img src="https://raw.githubusercontent.com/akhilrajmailbox/Web-Kubectl/master/img/webkubetoken.png" alt="2fa"></p>
<h2 id="conifgure-serviceaccount-for-the-deployment">Conifgure ServiceAccount for the deployment</h2>
<p><strong>Note</strong> : Need custom ServiceAccount for <code>web-kubectl</code></p>
<p>This is an example <code>ServiceAccount</code> creation yaml file. before creating the rbac, update the following terms in <code>rbac.yaml</code> file.</p>
<ul>
<li><code>namespace: web-kub</code> with your namespace</li>
<li><code>verbs: [&quot;get&quot;, &quot;watch&quot;, &quot;list&quot;]</code> &gt; this configuration having readonly permission, if you need more privilege for your <code>web-kubectl</code> to your cluster and <code>verbs: [&quot;create&quot;]</code> for <code>pods/exec</code> to run exec commands, you can <a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/">update</a> it, example : <code>verbs: [&quot;get&quot;, &quot;list&quot;, &quot;watch&quot;, &quot;create&quot;, &quot;update&quot;, &quot;patch&quot;, &quot;delete&quot;]</code></li>
</ul>
<pre><code>---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: webkubsrvaccount
  namespace: web-kub
---
apiVersion: rbac.authorization.k8s.io/v1beta1
kind: ClusterRole
metadata:
  name: webkub-clusterrole
rules:
# Just an example, feel free to change it
- apiGroups: [&quot;&quot;]
  resources: [&quot;*&quot;]
  verbs: [&quot;get&quot;, &quot;watch&quot;, &quot;list&quot;]
---
apiVersion: rbac.authorization.k8s.io/v1beta1
kind: ClusterRoleBinding
metadata:
  name: webkub-clusterrolebinding
subjects:
- kind: ServiceAccount
  name: webkubsrvaccount
  namespace: web-kub
roleRef:
  kind: ClusterRole
  name: webkub-clusterrole
  apiGroup: rbac.authorization.k8s.io
---
## for pod exec commands
apiVersion: rbac.authorization.k8s.io/v1beta1
kind: ClusterRole
metadata:
  name: webkub-pod-clusterrole
rules:
- apiGroups: [&quot;&quot;]
  resources: [&quot;pods/exec&quot;]
  verbs: [&quot;create&quot;]
---
apiVersion: rbac.authorization.k8s.io/v1beta1
kind: ClusterRoleBinding
metadata:
  name: webkub-pod-clusterrolebinding
subjects:
- kind: ServiceAccount
  name: webkubsrvaccount
  namespace: web-kub
roleRef:
  kind: ClusterRole
  name: webkub-pod-clusterrole
  apiGroup: rbac.authorization.k8s.io</code></pre><p>Create the rbac on your cluster after update the file</p>
<pre><code>kubectl create ns web-kub
kubectl apply -f rbac.yaml</code></pre><h2 id="configure-helm-charts-on-your-k8s-server-if-your-helm-client-version--3xx">Configure Helm charts on your k8s server if your helm client version &lt; 3.x.x</h2>
<pre><code>kubectl create serviceaccount --namespace=kube-system tiller
kubectl create clusterrolebinding tiller-cluster-rule --clusterrole=cluster-admin --serviceaccount=kube-system:tiller
helm init --service-account tiller</code></pre><h2 id="helm-chart-deployment-on-kubernetes-tldr">helm chart deployment on kubernetes (TL;DR;)</h2>
<pre><code>helm repo add ar-webkub https://akhilrajmailbox.github.io/Web-Kubectl/docs
helm install ar-webkub/web-kub -n web-kubectl --namespace=web-kub --set ssh.username=kubectl,ssh.password=randompassword</code></pre><p><strong>Note</strong> : The default <code>ssh.username</code> is <code>kubectl</code> but default <code>ssh.password</code> is empty. so if you forget to pass these variables, then your deployment will crash. (not passing <code>ssh.password</code> is because of some security concern)</p>
<h2 id="chart-configuration">chart Configuration</h2>
<p>The following table lists the configurable parameters of the <code>web-kub</code> chart and default values.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody><tr>
<td>replicaCount</td>
<td>number of pods to deploy</td>
<td>1</td>
</tr>
<tr>
<td>image.repository</td>
<td>image repository</td>
<td>akhilrajmailbox/web-kubectl</td>
</tr>
<tr>
<td>image.tag</td>
<td>image tag</td>
<td>1.0.1</td>
</tr>
<tr>
<td>image.pullPolicy</td>
<td>image repository</td>
<td>Always</td>
</tr>
<tr>
<td>serviceaccount</td>
<td>Service Account for the deployment to communicate with k8s</td>
<td>webkubsrvaccount</td>
</tr>
<tr>
<td>ssh.username</td>
<td>username for ssh / web access</td>
<td>kubectl</td>
</tr>
<tr>
<td>ssh.password</td>
<td>password for the user <code>ssh.username</code></td>
<td>-</td>
</tr>
<tr>
<td>kubeconfig</td>
<td>enable / disbale auto configuration for kubectl</td>
<td>true</td>
</tr>
<tr>
<td>service.port</td>
<td>TCP port</td>
<td>80</td>
</tr>
<tr>
<td>service.type</td>
<td>K8S service type exposing ports, e.g. <code>ClusterIP</code></td>
<td>LoadBalancer</td>
</tr>
<tr>
<td>persistence.enabled</td>
<td>enable / disable persistence volume</td>
<td>ReadWriteOnce</td>
</tr>
<tr>
<td>persistence.accessMode</td>
<td>Use volume as ReadOnly or ReadWrite</td>
<td>ReadWriteOnce</td>
</tr>
<tr>
<td>persistence.annotations</td>
<td>Persistent Volume annotations</td>
<td>{}</td>
</tr>
<tr>
<td>persistence.size</td>
<td>Size of data volume (adjust for production!)</td>
<td>50Gi</td>
</tr>
<tr>
<td>persistence.storageClass</td>
<td>Storage class of PVC</td>
<td>default</td>
</tr>
<tr>
<td>resources.requests.cpu</td>
<td>minimum CPU for deployment</td>
<td>100m</td>
</tr>
<tr>
<td>resources.requests.memory</td>
<td>minimum memory for deployment</td>
<td>128Mi</td>
</tr>
<tr>
<td>nodeSelector</td>
<td>Node labels for pod assignment</td>
<td>{}</td>
</tr>
<tr>
<td>tolerations</td>
<td>Toleration labels for pod assignment</td>
<td>[]</td>
</tr>
<tr>
<td>affinity</td>
<td>Affinity settings for pod assignment</td>
<td>{}</td>
</tr>
</tbody></table>
